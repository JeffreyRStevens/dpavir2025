{
  "hash": "b2c5f1809be75b5d5e280276bce1562d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Grammar of graphics II\"\nauthor: \"Jeff Stevens\"\ndate: \"2023-04-03\"\ndate-format: iso\nexecute:\n  echo: true\n  freeze: auto\nformat:\n  revealjs: \n    theme: custom.scss\n    slide-number: true\n    code-line-numbers: false\n    highlight-style: github\n    code-overflow: wrap\n    footer: \"[DPaViR 2025](https://jeffreyrstevens.github.io/dpavir2025)\"\n    code-link: true\n    logo: \"../logo/dpavir_hex.png\"\n---\n\n\n\n\n\n# Introduction\n\n\n## Set-up\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n\n\n## Seven components/layers of ggplots\n* Data\n* Mappings -- maps data to properties of geom\n* Geom -- represents data\n* Stat -- transforms data\n* Position -- control placement of data on coordinate\n* Facet -- split graph into subplots\n* Coordinate -- places data in coordinate system\n\n\n# Aesthetics\n\n## Map data to visual properties\n\n![](../images/ggplot2_simplified.png){fig-align=\"center\"}\n\n\n## Map data columns to plot\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-2-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n## Size\n\n:::: {.columns}\n\n:::{.column size=\"50%\"}\nMap data to aesthetic\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy, size = cty)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-3-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::{.column size=\"50%\"}\n\n::: {.fragment}\nApply to all points\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy)) +\n  geom_point(size = 0.5)\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-4-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::\n::::\n\n\n## Transparency\n\n:::: {.columns}\n\n:::{.column size=\"50%\"}\nMap data to aesthetic\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy, alpha = cty)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-5-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::{.column size=\"50%\"}\n\n::: {.fragment}\nApply to all points\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy)) +\n  geom_point(alpha = 0.25)\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-6-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::\n::::\n\n\n## Shape\n\n:::: {.columns}\n\n:::{.column size=\"50%\"}\nMap data to aesthetic\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy, shape = class)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-7-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::{.column size=\"50%\"}\n\n::: {.fragment}\nApply to all points\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy)) +\n  geom_point(shape = 5)\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-8-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::\n::::\n\n\n## Shapes\n\n<!-- Tattoo to forearm -->\n\n![](../images/r_point_symbols.png){fig-align=\"center\"}\n\n\n## Color\n\n:::: {.columns}\n\n:::{.column size=\"50%\"}\nMap data to aesthetic\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy, color = class)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-9-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::{.column size=\"50%\"}\n\n::: {.fragment}\nApply to all points\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy)) +\n  geom_point(color = \"dodgerblue\")\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-10-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::\n::::\n\n\n## Color\n\nWhat happens if we put it in the aesthetic?\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy, color = \"dodgerblue\")) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-11-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n## Color: points, lines, text, and borders\n\n:::: {.columns}\n\n:::{.column size=\"50%\"}\nMap data to aesthetic\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = class, color = class)) +\n  geom_bar(show.legend = FALSE, linewidth = 2)\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-12-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::{.column size=\"50%\"}\n\n::: {.fragment}\nApply to everything\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = class)) +\n  geom_bar(color = \"blue\", linewidth = 2)\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-13-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::\n::::\n\n\n## Fill: filled areas\n\n:::: {.columns}\n\n:::{.column size=\"50%\"}\nMap data to aesthetic\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = class, fill = class)) +\n  geom_bar(show.legend = FALSE)\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-14-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n:::{.column size=\"50%\"}\n\n::: {.fragment}\nApply to everything\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = class)) +\n  geom_bar(fill = \"blue\")\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-15-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::\n::::\n\n\n## Lines \n\nSeparated by groups\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy, group = drv)) +\n  geom_smooth()\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-16-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n## Linetype\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy, linetype = drv)) +\n  geom_smooth()\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-17-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n## Apply line aesthetics to groups\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy, color = drv)) +\n  geom_smooth(show.legend = FALSE)\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-18-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n<!-- ## We can specify geom-specific aesthetics like only to lines -->\n<!-- ```{r fig.align = \"center\"} -->\n<!-- mpg |> -->\n<!--   ggplot(aes(x = displ, y = hwy)) + -->\n<!--   geom_point() + -->\n<!--   geom_smooth(aes(linetype = drv)) -->\n<!-- ``` -->\n\n## Apply aesthetics to one geom\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy)) +\n  geom_point(aes(color = class)) +\n  geom_smooth()\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-19-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n## Apply aesthetics differently to geoms\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy, color = drv)) +\n  geom_point() +\n  geom_smooth(aes(linetype = drv))\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-20-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n## Bands have aesthetics, too\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy)) +\n  geom_point() +\n  geom_smooth(aes(color = drv, fill = drv))\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-21-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n\n# Statistical transformations\n\n## Statistical transformations\n\n* ggplot can calculate statistics on the fly\n* many geoms have underlying statistical transformation\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiamonds\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 53,940 × 10\n   carat cut       color clarity depth table price     x     y     z\n   <dbl> <ord>     <ord> <ord>   <dbl> <dbl> <int> <dbl> <dbl> <dbl>\n 1  0.23 Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43\n 2  0.21 Premium   E     SI1      59.8    61   326  3.89  3.84  2.31\n 3  0.23 Good      E     VS1      56.9    65   327  4.05  4.07  2.31\n 4  0.29 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63\n 5  0.31 Good      J     SI2      63.3    58   335  4.34  4.35  2.75\n 6  0.24 Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48\n 7  0.24 Very Good I     VVS1     62.3    57   336  3.95  3.98  2.47\n 8  0.26 Very Good H     SI1      61.9    55   337  4.07  4.11  2.53\n 9  0.22 Fair      E     VS2      65.1    61   337  3.87  3.78  2.49\n10  0.23 Very Good H     VS1      59.4    61   338  4     4.05  2.39\n# ℹ 53,930 more rows\n```\n\n\n:::\n:::\n\n\n\n\n\n## Bar plots \n\nCount observations of variable types with `stat_count()`\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndiamonds |>\n  ggplot(aes(x = cut)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-23-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n## Summarize data \n\n:::: {.columns}\n\n:::{.column size=\"50%\"}\n`stat_summary()`\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndiamonds |>\n  ggplot(aes(x = cut, y = depth)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-24-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::{.column size=\"50%\"}\n\n::: {.fragment}\nPlot mean and standard error\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndiamonds |>\n  ggplot(aes(x = cut, y = depth)) +\n  stat_summary()\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-25-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::\n::::\n\n\n## Summarize data \n\n:::: {.columns}\n\n:::{.column size=\"50%\"}\nPlot mean and 95% CI\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndiamonds |>\n  ggplot(aes(x = cut, y = depth)) +\n  stat_summary(fun.data = mean_cl_normal)\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-26-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::{.column size=\"50%\"}\n\n::: {.fragment}\nPlot median and range\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndiamonds |>\n  ggplot(aes(x = cut, y = depth)) +\n  stat_summary(fun.min = min, fun.max = max, fun = median)\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-27-1.png){fig-align='center' width=500 height=400}\n:::\n:::\n\n\n\n:::\n\n:::\n::::\n\n\n\n# Facets\n\n## Facets\n\nColoring by group difficult to visualize with many groups\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy, color = class)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-28-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n## Facet\n\nPulls out groups into separate panels\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpg |>\n  ggplot(aes(x = displ, y = hwy)) +\n  geom_point() +\n  facet_wrap(~ class)\n```\n\n::: {.cell-output-display}\n![](27_grammar2_files/figure-revealjs/unnamed-chunk-29-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n\n\n\n## Let's code!\n\n[Grammar of graphics II](../code/27_grammar2.html){target=\"_blank\"} [[Rmd](../code/27_grammar2.Rmd){target=\"_blank\"}]\n",
    "supporting": [
      "27_grammar2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}